<!-- Example for WordPress embedding -->
<div class="fencing-calculator-container" style="width: 100%; max-width: 530px; margin: 0 auto;">
  <script>
    // Your API keys - KEEP THESE SECURE
    // In WordPress, you can use wp_localize_script to pass these values from PHP
    var FENCING_CONFIG = {
      GOOGLE_MAPS_API_KEY: "<?php echo esc_attr(get_option('fencing_google_maps_api_key')); ?>",
      GHL_API_KEY: "<?php echo esc_attr(get_option('fencing_ghl_api_key')); ?>",
      GHL_LOCATION_ID: "<?php echo esc_attr(get_option('fencing_ghl_location_id')); ?>",
      BOOKING_URL: "<?php echo esc_attr(get_option('fencing_booking_url')); ?>"
    };
  </script>
  
  <iframe 
    id="fencing-form-iframe"
    src="https://fencing-form-mzbpid.vercel.app/" 
    style="width: 100%; height: 765px; border: 0; outline: 0; box-shadow: none; background: transparent; overflow: visible;"
    frameborder="0" 
    allowtransparency="true"
    scrolling="no"
    onload="setupFencingIframe(this)"
  ></iframe>
  
  <script>
    function setupFencingIframe(iframe) {
      // Function to safely inject configuration
      function injectConfig() {
        try {
          const iframeWindow = iframe.contentWindow;
          if (!iframeWindow) return;
          
          // Create a secure way to pass configuration without exposing in DOM
          iframeWindow.postMessage({
            type: 'SETUP_CONFIG',
            config: FENCING_CONFIG
          }, '*');
          
          // Adjust iframe height
          adjustIframeHeight(iframe);
        } catch (error) {
          console.error('Error setting up iframe:', error);
        }
      }
      
      // Adjust iframe height based on content
      function adjustIframeHeight(iframe) {
        try {
          const height = Math.max(765, iframe.contentWindow.document.body.scrollHeight + 50);
          iframe.style.height = height + 'px';
        } catch (e) {
          console.log('Could not adjust height', e);
        }
      }
      
      // Initial setup
      setTimeout(injectConfig, 500);
      
      // Periodically check and adjust
      setInterval(() => {
        adjustIframeHeight(iframe);
      }, 1000);
      
      // Listen for messages from the iframe
      window.addEventListener('message', function(event) {
        // Handle resize requests
        if (event.data && event.data.type === 'resize-iframe') {
          iframe.style.height = (event.data.height + 20) + 'px';
        }
        
        // Handle form submission success
        if (event.data && event.data.type === 'form-submitted') {
          console.log('Form submitted successfully:', event.data.contactId);
          // You can add custom success handling here
        }
        
        // Handle form submission errors
        if (event.data && event.data.type === 'form-error') {
          console.error('Form submission error:', event.data.error);
          // You can add custom error handling here
        }
        
        // Handle API key requests
        if (event.data && event.data.type === 'REQUEST_CONFIG') {
          injectConfig();
        }
      });
    }
  </script>
</div>
